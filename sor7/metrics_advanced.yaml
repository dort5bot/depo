# schemas/metrics_advanced.yaml
metrics:
  Kalman_Filter_Trend:
    description: "1D Kalman filtresi ile gürültülü sinyalin trendini yumuşatır."
    formula: "x_hat[k] = x_hat[k-1] + K[k] * (x[k] - x_hat[k-1])"
    parameters:
      process_variance:
        type: float
        default: 1e-5
        description: "Sistem gürültü varyansı"
      measurement_variance:
        type: float
        default: 0.01
        description: "Ölçüm gürültü varyansı"
    output_type: "series"

  Wavelet_Transform:
    description: "Discrete Wavelet Transform (DWT) ile sinyalin detay ve yaklaşık katsayılarını çıkarır."
    formula: "x_reconstructed = waverec(wavedec(x, wavelet, level))"
    parameters:
      wavelet:
        type: str
        default: "db4"
        description: "Kullanılacak dalgacık tipi"
      level:
        type: int
        default: 2
        description: "DWT seviyesinin sayısı"
    output_type: "series"

  Hilbert_Transform_Slope:
    description: "Analitik sinyalin faz eğimini hesaplar; anlık faz değişimini ölçer."
    formula: "slope = gradient(unwrap(angle(hilbert(x))))"
    parameters: {}
    output_type: "series"

  Hilbert_Transform_Amplitude:
    description: "Analitik sinyalin anlık genliğini hesaplar."
    formula: "amplitude = abs(hilbert(x))"
    parameters: {}
    output_type: "series"

  Fractal_Dimension_Index_FDI:
    description: "Higuchi yöntemi ile Fraktal Boyut İndeksi (FDI) hesaplar; yüksek FDI → daha gürültülü sinyal."
    formula: "FDI ≈ -slope(log(k), log(L(k)))"
    parameters:
      k_max:
        type: int
        default: 100
        description: "Kapsama penceresi boyutu"
    output_type: "float"

  Shannon_Entropy:
    description: "Sinyalin Shannon entropisini hesaplar."
    formula: "H = -sum(p_i * log2(p_i))"
    parameters:
      bins:
        type: int
        default: 30
        description: "Histogram bölme sayısı"
    output_type: "float"

  Permutation_Entropy:
    description: "Bandt & Pompe yöntemi ile zaman serisi karmaşıklığını ölçer."
    formula: "H_perm = -sum(probabilities * log2(probabilities))"
    parameters:
      order:
        type: int
        default: 3
        description: "Permütasyon sırası"
      delay:
        type: int
        default: 1
        description: "Gecikme parametresi"
    output_type: "float"

  Sample_Entropy:
    description: "Sample entropy tahmini ile sinyal karmaşıklığını ölçer."
    formula: "SampEn = -log(phi(m+1)/phi(m))"
    parameters:
      m:
        type: int
        default: 2
        description: "Embed boyutu"
      r:
        type: float
        default: null
        description: "Eşik mesafe; varsayılan %20 standart sapma"
    output_type: "float"
    
  Granger_Causality:
    description: "Granger nedensellik testi ile iki zaman serisi arasındaki nedensellik ilişkisini test eder."
    formula: "F_statistic = ((RSS_r - RSS_ur) / p) / (RSS_ur / (T - 2*p - 1))"
    parameters:
      max_lag:
        type: int
        default: 5
        description: "Maksimum gecikme sayısı"
      significance_level:
        type: float
        default: 0.05
        description: "Anlamlılık seviyesi"
    output_type: "dict"

  Phase_Shift_Index:
    description: "İki sinyal arasındaki faz kaymasını hesaplar."
    formula: "PSI = mean(angle(signal1 * conj(signal2)))"
    parameters:
      method:
        type: str
        default: "hilbert"
        description: "Faz hesaplama yöntemi (hilbert veya fft)"
    output_type: "float"